<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ostoskori</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/Ostoskori.css">
</head>
<body onload="lataaKori()">
<header>
    <div class="top">
        <div class="login">
            <form class="kayttaja">
                <input type="email" name="sposti" placeholder="Sähköposti.."></input>
                <input type="password" name="psw" placeholder="Salasana.."></input>
                <button id="kirjaudu">Kirjaudu</button>
                <a href="Login.html">Luo tunnus</a>
            </form>
        </div>
        <h1>Verkkokauppa</h1>
        <div class="haku">
            <div class="nav">
                <a href="Etusivu.html">Etusivu</a>
                <a href="Verkkokauppa.html">Tuotteet</a>
                <a>Ota yhteyttä</a>
                <a href="Ostoskori.html">Ostoskori</a>
            </div>
        </div>
    </div>
</header>
<div id="sisalto">
    <div id="kori">
        <h3>Ostoskori</h3>
        <table id="ostoskori">
            <tr>
                <th></th>
                <th>Tuote</th>
                <th>Määrä</th>
                <th>Hinta</th>
                <th></th>
            </tr>
        </table>

        <p id="total">Yhteensä: 0€</p>
        <button onclick="clearKori()">Tyhjennä Ostoskori</button>
    </div>
</div>

<script>

    var tuotteet = {
        tuotteet: [
            {
                Id: "0",
                name: " ",
                img: " ",
                price: " "
            },
            {
                Id: "1",
                name: "Oneplus 6 64Gt",
                img: "../pics/OnePlus_6_MirrorBlack_image1.png",
                price: "518,40€"
            },
            {
                Id: "2",
                name: "MSI 15.6\" P65 Creator 8RD",
                img: "../pics/msi4.1.png",
                price: "1779,00€"
            },
            {
                Id: "3",
                name: "Kingston HyperX FURY DDR4",
                img: "../pics/2_392408-780x399.jpeg",
                price: "100,90€"
            },
            {
                Id: "4",
                name: "MSI Radeon VII 16G",
                img: "../pics/2_531432-1024x818.jpg",
                price: "799,90€"
            },
            {
                Id: "5",
                name: "Huawei P30 128Gt",
                img: "../pics/2_532749-672x1096.jpg",
                price: "699,90€"
            },
            {
                Id: "6",
                name: "Lenovo ThinkPad E480 14",
                img: "../pics/2_473978-2778x2289.jpeg",
                price: "1329,90€"
            },
            {
                Id: "7",
                name: "Kingston DataTraveler 100 G3",
                img: "../pics/2_164178-800x500.jpeg",
                price: "10,90€"
            },
            {
                Id: "8",
                name: "Lenovo Ideapad 330 15,6",
                img: "../pics/2_485352-2650x2129.jpg",
                price: "649,90€"
            },
            {
                Id: "9",
                name: "Corsair Valueselect 32Gt",
                img: "../pics/2_351047-714x408.jpg",
                price: "199,90€"
            },
            {
                Id: "10",
                name: "Corsair Gaming K55 RGB",
                img: "../pics/2_358585-1717x686.jpg",
                price: "54,90€"
            },
            {
                Id: "11",
                name: "Asus GL703GM 17,3",
                img: "../pics/2_489510-1112x760.jpeg",
                price: "1799,90€"
            },
            {
                Id: "12",
                name: "Samsung 970 EVO 500Gt M.2",
                img: "../pics/evo970500.jpg",
                price: "156,90€"
            },
            {
                Id: "13",
                name: "Logitech B100",
                img: "../pics/2_343877-488x338.jpg",
                price: "12,90€"
            },
            {
                Id: "14",
                name: "HP HDMI - VGA -adapteri",
                img: "../pics/2_160206-1104x910.jpeg",
                price: "9,90€"
            },
            {
                Id: "15",
                name: "Nokia 7 Plus",
                img: "../pics/2_459936-338x685.jpeg",
                price: "378,90€"
            },
            {
                Id: "16",
                name: "Huawei Mate 20 Lite",
                img: "../pics/2_497430-1902x4000.jpg",
                price: "349,00€"
            }

        ]
    };

    function lataaKori() {

        var kori = localStorage.ostoskori;
        console.log(kori);
        var res = kori.split(",");
        console.log(tuotteet.tuotteet[1].name);

        for (var i = 1; i < res.length; i++) {

            var node = document.createElement("tr");
            var name = document.createElement("td");
            name.innerText = (tuotteet.tuotteet[res[i]].name);
            var image = document.createElement("img");
            image.setAttribute("src", tuotteet.tuotteet[res[i]].img);
            var price = document.createElement("td");
            price.innerText = (tuotteet.tuotteet[res[i]].price);
            price.setAttribute("class", "price");
            var maara = document.createElement("td");
            maara.innerText = ("1");                    // placeholder
            var poista = document.createElement("td");
            poista.innerText = "X";
            poista.setAttribute("class", "poista");
            node.appendChild(image);
            node.appendChild(name);
            node.appendChild(maara);
            node.appendChild(price);
            node.appendChild(poista);
            document.getElementById("ostoskori").appendChild(node);

        }

        var hinnat = document.getElementsByClassName("price");
        var summa = 0;
        for (var i = 0; i < hinnat.length; i++) {
            var thinta = hinnat[i].textContent;
            var strhinta = thinta.slice(0, thinta.length - 1);
            var floathinta = strhinta.replace(",", ".");
            parseFloat(floathinta);
            summa += parseFloat(floathinta);
        }
        var strSumma = summa.toString();
        summa = strSumma.replace(".", ",");
        document.getElementById("total").innerText = "Yhteensä: " + summa + "€";
    }

    function clearKori() {
        window.localStorage.clear();
        console.log('asd');
        document.getElementById("ostoskori").innerHTML = "Korisi on tyhjä";
        document.getElementById("total").innerText = "Yhteensä: 0€"
    }

</script>
</body>
</html>